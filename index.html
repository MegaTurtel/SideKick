<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAMRAM - מערכת דיווח וניהול</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy: #08172e;
            --mint: #4ecdc4;
            --cyan: #00d4ff;
        }

        * { box-sizing: border-box; font-family: 'Heebo', sans-serif; }

        body {
            margin: 0;
            min-height: 100vh;
            background: radial-gradient(circle at 20% 20%, #122f5a, transparent 40%), linear-gradient(180deg, #020916, #050f22);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .splash-card {
            padding: 30px;
            border-radius: 22px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            max-width: 800px; /* מורחב כדי שיהיה מקום לטבלה */
            width: 100%;
            text-align: center;
            transition: 0.3s ease;
        }

        h1 { font-size: 36px; margin-bottom: 20px; color: var(--navy); }

        button {
            padding: 12px 24px; font-size: 18px; font-weight: 700; border-radius: 36px;
            cursor: pointer; border: none; transition: 0.25s; margin: 10px;
        }

        .teacher-btn { background: var(--navy); color: white; }
        .student-btn { background: linear-gradient(135deg, var(--mint), var(--cyan)); color: #043534; }
        .submit-btn { background: linear-gradient(135deg, var(--mint), var(--cyan)); color: #043534; width: 100%; }

        /* אזורי תוכן */
        #loginOptions { display: block; }
        #studentForm { display: none; flex-direction: column; gap: 10px; text-align: right; }
        #teacherDashboard { display: none; flex-direction: column; text-align: right; }

        input, textarea { padding: 12px; border-radius: 8px; border: 1px solid #ccc; width: 100%; font-size: 16px; }

        /* עיצוב טבלה למורה */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            font-size: 14px;
        }

        th, td { padding: 12px; border: 1px solid #eee; text-align: right; }
        th { background: var(--navy); color: white; }
        tr:nth-child(even) { background: #f9f9f9; }

        .back-link { display: block; margin-top: 20px; color: gray; text-decoration: underline; cursor: pointer; }
    </style>
</head>
<body>

<div class="splash-card" id="mainCard">
    <h1>MAMRAM</h1>
    
    <div id="loginOptions">
        <button class="teacher-btn" onclick="showTeacher()">כניסת מורה (צפייה בדיווחים)</button>
        <button class="student-btn" onclick="showStudent()">כניסת תלמיד (דיווח חדש)</button>
    </div>

    <form id="studentForm">
        <h2 style="color: var(--navy)">דיווח חדש</h2>
        <input type="text" id="className" placeholder="הכיתה שלך" required>
        <input type="text" id="victimClass" placeholder="כיתת הנפגע" required>
        <textarea id="msg" placeholder="פירוט המקרה..." rows="3" required></textarea>
        <button type="submit" class="submit-btn">שלח דיווח</button>
        <span class="back-link" onclick="resetUI()">חזור</span>
    </form>

    <div id="teacherDashboard">
        <h2 style="color: var(--navy)">דיווחים שהתקבלו במערכת</h2>
        <div style="overflow-x: auto;">
            <table id="reportsTable">
                <thead>
                    <tr>
                        <th>זמן</th>
                        <th>מדווח</th>
                        <th>כיתת נפגע</th>
                        <th>הודעה</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    </tbody>
            </table>
        </div>
        <button onclick="clearData()" style="background: #ff4d4d; color: white; font-size: 14px; margin-top: 10px;">מחק את כל הדיווחים</button>
        <span class="back-link" onclick="resetUI()">חזור לתפריט</span>
    </div>
</div>

<script>
    // --- ניהול תצוגה ---
    function showStudent() {
        document.getElementById('loginOptions').style.display = 'none';
        document.getElementById('studentForm').style.display = 'flex';
    }

    function showTeacher() {
        document.getElementById('loginOptions').style.display = 'none';
        document.getElementById('teacherDashboard').style.display = 'flex';
        renderTable();
    }

    function resetUI() {
        document.getElementById('loginOptions').style.display = 'block';
        document.getElementById('studentForm').style.display = 'none';
        document.getElementById('teacherDashboard').style.display = 'none';
    }

    // --- ניהול נתונים (LocalStorage) ---
    
    // שליחת דיווח
    document.getElementById('studentForm').onsubmit = function(e) {
        e.preventDefault();

        const newReport = {
            time: new Date().toLocaleString('he-IL'),
            from: document.getElementById('className').value,
            victim: document.getElementById('victimClass').value,
            message: document.getElementById('msg').value
        };

        // שמירה מקומית (בדפדפן)
        let reports = JSON.parse(localStorage.getItem('mamram_reports')) || [];
        reports.push(newReport);
        localStorage.setItem('mamram_reports', JSON.stringify(reports));

        alert("הדיווח נשלח ונשמר במערכת!");
        this.reset();
        resetUI();
    };

    // הצגת הטבלה למורה
    function renderTable() {
        const reports = JSON.parse(localStorage.getItem('mamram_reports')) || [];
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';

        if (reports.length === 0) {
            tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;">אין דיווחים במערכת</td></tr>';
            return;
        }

        reports.reverse().forEach(report => {
            const row = `<tr>
                <td>${report.time}</td>
                <td>${report.from}</td>
                <td>${report.victim}</td>
                <td>${report.message}</td>
            </tr>`;
            tbody.innerHTML += row;
        });
    }

    function clearData() {
        if(confirm("האם אתה בטוח שברצונך למחוק את כל הנתונים?")) {
            localStorage.removeItem('mamram_reports');
            renderTable();
        }
    }
</script>

</body>
</html>
